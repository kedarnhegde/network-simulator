from dataclasses import dataclass, field
from typing import Literal, Optional, Tuple
import itertools, time

MacKind = Literal["WiFi", "BLE", "Zigbee"]

_seq = itertools.count(1)

@dataclass
class MacConfig:
    # CSMA/CA
    slot_ms: int = 10
    cw_min: int = 4
    cw_max: int = 32
    retry_limit: int = 4
    ack_delay_slots: int = 1

    # Loss model
    base_loss_prob: float = 0.0     # random channel loss
    collision_losses: bool = True   # if >1 TX in a slot â†’ all fail

    # Queue
    queue_capacity: int = 64

@dataclass
class Packet:
    src_id: int
    dst_id: int
    size_bytes: int = 100
    kind: MacKind = "WiFi"
    seq: int = field(default_factory=lambda: next(_seq))
    t_created: float = field(default_factory=time.time)  # seconds
